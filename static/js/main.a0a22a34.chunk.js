(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{140:function(e,t,a){"use strict";(function(e){var n=a(78),r=a(5),s=a.n(r),i=a(11),o=a(34),c=a(35),l=a(56),u=a(39),p=a(36),d=a(19),m=a(38),f=a(1),h=a.n(f),v=(a(89),a(159)),g=a.n(v),b=a(160),y=a.n(b),x=a(40),w=a.n(x),I=a(161),S=a.n(I),k=a(26),j=a.n(k),E=(a(176),a(158)),O=a.n(E),P=a(33),C=a(83),T=a(157),F=a.n(T),A=a(84),D=a.n(A),N=a(85),R=a.n(N),B=a(86),M=a.n(B),L=a(87),_=a.n(L),q=a(162),J=a.n(q),V=a(20),z=a.n(V),W=a(163),U=a.n(W),Y=a(37),G=a.n(Y),K=a(164),H=a.n(K),$=a(165),Q=a(152),X=a.n(Q),Z=a(156),ee=a.n(Z),te=a(155),ae=a.n(te),ne=a(154),re=a.n(ne),se=a(142),ie=a.n(se),oe=a(58),ce=a(143),le=a(147),ue=a.n(le),pe=a(148),de=a.n(pe),me=a(149),fe=a.n(me),he=a(150),ve=a.n(he),ge=a(151),be=a.n(ge),ye=1,xe="dbInfo.json",we="aliases.json",Ie="origSubs.json",Se="vtts.json",ke=2,je=50,Ee="https://www.googleapis.com/auth/drive.appdata";Ee+=" https://www.googleapis.com/auth/photoslibrary.readonly";var Oe=[{postfix:"=m37",label:"1080p"},{postfix:"=m22",label:"720p"},{postfix:"=m18",label:"360p"}],Pe=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},a.componentDidMount=function(){return a.props.onRef(Object(d.a)(a))},a.handleClickOpen=function(){return a.setState({open:!0})},a.handleClose=function(){return a.setState({open:!1})},a.handleYes=function(){var e=a.props.app;a.setState({open:!1}),e.initUserVars(),e.gapi.auth2.getAuthInstance().signOut()},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return h.a.createElement(X.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},h.a.createElement(re.a,{id:"alert-dialog-title"},"Logout?"),h.a.createElement(ae.a,null),h.a.createElement(ee.a,null,h.a.createElement(G.a,{onClick:this.handleYes,color:"primary"},"Yes")))}}]),t}(h.a.Component),Ce=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).handleTopLeft=function(){var e=a.props.app;"main"===e.state.curPage?a.logoutDialog.setState({open:!0}):"album"===e.state.curPage?e.changePage("main"):"play"===e.state.curPage&&e.changePage("album")},a.handleTitle=function(e){var t=e.target.value,n=a.props.app,r=n.state.curItem;a.aliasTimer&&clearTimeout(a.aliasTimer),a.aliasTimer=setTimeout(function(){var e={};e[r.id]=t||r.filename,n.updateAliases(e),a.aliasTimer=null},1e3*ke)},a.render=function(){var e,t,n=a.props.classes,r=a.props.app;if("main"===r.state.curPage){var s=r.gapi.auth2.getAuthInstance();e=h.a.createElement(j.a,{variant:"h6",color:"inherit",noWrap:!0},s.currentUser.get().getBasicProfile().getEmail()," (",r.state.albums.length,")"),t=h.a.createElement(F.a,null)}else if("album"===r.state.curPage)e=h.a.createElement(j.a,{variant:"h6",color:"inherit",noWrap:!0},r.state.curAlbum.title," (",r.state.mediaItems.length,")"),t=h.a.createElement(w.a,null,"arrow_back");else if("play"===r.state.curPage){if(r.state.curItem){var i=r.state.curItem,o=r.state.aliases[i.id]||r.state.curItem.filename;e=h.a.createElement(O.a,{defaultValue:o,fullWidth:!0,style:{color:"inherit"},onChange:function(e){return a.handleTitle(e)},placeholder:r.state.curItem.filename})}t=h.a.createElement(w.a,null,"arrow_back")}return h.a.createElement("div",{className:n.root},h.a.createElement(Pe,{onRef:function(e){a.logoutDialog=e},app:a.props.app}),h.a.createElement(g.a,{position:"fixed"},h.a.createElement(y.a,null,h.a.createElement(S.a,{className:n.menuButton,color:"inherit","aria-label":"Open drawer",onClick:function(){return a.handleTopLeft()}},t),e)))},a}return Object(m.a)(t,e),t}(f.Component);Ce=Object(C.withStyles)(function(e){return{root:{width:"100%"},grow:{flexGrow:1},menuButton:{marginLeft:-12,marginRight:20},title:Object(o.a)({display:"none"},e.breakpoints.up("sm"),{display:"block"}),search:Object(o.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(P.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(P.fade)(e.palette.common.white,.25)},marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing.unit,width:"auto"}),searchIcon:{width:9*e.spacing.unit,height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:Object(o.a)({paddingTop:e.spacing.unit,paddingRight:e.spacing.unit,paddingBottom:e.spacing.unit,paddingLeft:10*e.spacing.unit,transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("sm"),{width:120,"&:focus":{width:200}})}})(Ce);var Te=function(t){function a(){var t,r;Object(c.a)(this,a);for(var o=arguments.length,l=new Array(o),m=0;m<o;m++)l[m]=arguments[m];return(r=Object(u.a)(this,(t=Object(p.a)(a)).call.apply(t,[this].concat(l)))).state={isSignedIn:!1,curPage:"loading"},r.initUserVars=function(){return r.albums=[],r.mediaItems=[],r.aliases={},r.origSubs={},r.vtts={},r.setState({albums:[],curAlbum:{},mediaItems:[],curItem:null,nextResIdx:0,refreshPlayer:!1,currentTime:0,aliases:{},origSubs:{},vtts:{}})},r.componentDidMount=Object(i.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.initUserVars();case 2:r.albums=[],(t=document.createElement("script")).src="https://apis.google.com/js/api.js",t.onload=function(){r.gapi=window.gapi,r.gapi.load("client:auth2",Object(i.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.gapi.client.init({apiKey:oe.API_KEY,clientId:oe.CLIENT_ID,discoveryDocs:oe.DISCOVERY_DOCS,scope:Ee});case 2:r.gapi.auth2.getAuthInstance().isSignedIn.listen(r.updateSigninStatus),r.updateSigninStatus(r.gapi.auth2.getAuthInstance().isSignedIn.get());case 4:case"end":return e.stop()}},e)})))},document.body.appendChild(t);case 7:case"end":return e.stop()}},e)})),r.updateDB=Object(i.a)(s.a.mark(function e(){var t,a,n,i,o,c,l,u,p,d,m,f,h,v,g,b,y,x,w,I,S,k,j,E,O;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(t=r.dbInfo.version)){e.next=75;break}return(a=[]).push(r.createFile(we).then(function(e){return r.aliasesId=e,r.aliases={},r.updateAliases({})})),a.push(r.createFile(Ie).then(function(e){return r.origSubsId=e,r.origSubs={},r.updateOrigSubs({})})),a.push(r.createFile(Se).then(function(e){return r.vttsId=e,r.vtts={},r.updateVtts({})})),e.next=8,Promise.all(a);case 8:return"meta.json",e.next=11,r.listFiles("meta.json");case 11:if(!((n=e.sent).length>0)){e.next=25;break}return i=n[0].id,e.t0=JSON,e.next=17,r.getFile(i);case 17:for(u in e.t1=e.sent,o=e.t0.parse.call(e.t0,e.t1),c={},l=!1,o)o[u].alias&&(c[u]=o[u].alias,l=!0);if(!l){e.next=24;break}return e.next=24,r.updateAliases(c);case 24:r.delFile(i);case 25:return p=r.gapi.client.drive,e.next=28,p.files.list({q:'mimeType="application/vnd.google-apps.folder"',spaces:"appDataFolder",fields:"files(id, name)",pageSize:1e3});case 28:for(d=e.sent,m={},f=!0,h=!1,v=void 0,e.prev=33,g=d.result.files[Symbol.iterator]();!(f=(b=g.next()).done);f=!0)y=b.value,m[y.id]=y.name;e.next=41;break;case 37:e.prev=37,e.t2=e.catch(33),h=!0,v=e.t2;case 41:e.prev=41,e.prev=42,f||null==g.return||g.return();case 44:if(e.prev=44,!h){e.next=47;break}throw v;case 47:return e.finish(44);case 48:return e.finish(41);case 49:return x={},e.next=52,r.listFiles("captions.vtt");case 52:for(w=e.sent,I=!0,S=!1,k=void 0,e.prev=56,j=w[Symbol.iterator]();!(I=(E=j.next()).done);I=!0)O=E.value,x[m[O.parents[0]]]=O.id;e.next=64;break;case 60:e.prev=60,e.t3=e.catch(56),S=!0,k=e.t3;case 64:e.prev=64,e.prev=65,I||null==j.return||j.return();case 67:if(e.prev=67,!S){e.next=70;break}throw k;case 70:return e.finish(67);case 71:return e.finish(64);case 72:return e.next=74,r.updateVtts(x);case 74:t++;case 75:return e.next=77,r.updateDBInfo({version:t});case 77:case"end":return e.stop()}},e,null,[[33,37,41,49],[42,,44,48],[56,60,64,72],[65,,67,71]])})),r.updateDBInfo=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var c=i.value;delete r.dbInfo[c]}}catch(l){n=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}Object.assign(r.dbInfo,e),r.writeFile(r.dbInfoId,JSON.stringify(r.dbInfo))},r.updateAliases=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var c=i.value;delete r.aliases[c]}}catch(l){n=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}return Object.assign(r.aliases,e),r.setState({aliases:r.aliases}),r.writeFile(r.aliasesId,JSON.stringify(r.aliases))},r.updateVtts=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var c=i.value;delete r.vtts[c]}}catch(l){n=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}return Object.assign(r.vtts,e),r.setState({vtts:r.vtts}),r.writeFile(r.vttsId,JSON.stringify(r.vtts))},r.updateOrigSubs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=!0,n=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(a=(i=o.next()).done);a=!0){var c=i.value;delete r.origSubs[c]}}catch(l){n=!0,s=l}finally{try{a||null==o.return||o.return()}finally{if(n)throw s}}return Object.assign(r.origSubs,e),r.setState({origSubs:r.origSubs}),r.writeFile(r.origSubsId,JSON.stringify(r.origSubs))},r.handleSigninClick=function(e){return r.gapi.auth2.getAuthInstance().signIn()},r.handleSignoutClick=function(e){return r.gapi.auth2.getAuthInstance().signOut()},r.handleAlbumClick=function(e){r.getMediaItems(e.id),r.setState({curAlbum:e}),r.changePage("album")},r.handleItemClick=function(e){r.getMediaItem(e.id),r.changePage("play")},r.handleDelSubtitle=Object(i.a)(s.a.mark(function e(){var t,a,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=r.state.curItem.id,a=r.state.origSubs[t],n=r.state.vtts[t],a&&r.delFile(a),n&&r.delFile(n),r.updateOrigSubs({},[t]),r.updateVtts({},[t]),"play"===r.state.curPage&&r.videoPlayer.removeSubtitle();case 8:case"end":return e.stop()}},e)})),r.handleDownloadSubtitle=Object(i.a)(s.a.mark(function t(){var a,n,i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.state.origSubs[r.state.curItem.id],t.next=3,r.getFileMetaInfo(a);case 3:return n=t.sent,t.t0=e,t.t1=JSON,t.next=8,r.getFile(a);case 8:t.t2=t.sent,t.t3=t.t1.parse.call(t.t1,t.t2).data,i=t.t0.from.call(t.t0,t.t3),be()(i,n.name);case 12:case"end":return t.stop()}},t)})),r.updateSigninStatus=function(){var e=Object(i.a)(s.a.mark(function e(t){var a,n,o;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=35;break}return e.next=3,r.listFiles(xe);case 3:if(!((a=e.sent).length>0)){e.next=16;break}return r.dbInfoId=a[0].id,e.next=8,r.getFile(r.dbInfoId);case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0="{}";case 11:n=e.t0,r.dbInfo=JSON.parse(n),void 0===r.dbInfo.version&&(r.dbInfo.version=0),e.next=22;break;case 16:return r.dbInfo={},e.next=19,r.createFile(xe);case 19:return r.dbInfoId=e.sent,e.next=22,r.updateDBInfo({version:0});case 22:if(!(r.dbInfo.version<ye)){e.next=25;break}return e.next=25,r.updateDB();case 25:return(o=[]).push(r.listFiles(we).then(function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.aliasesId=t[0].id,e.t0=JSON,e.next=4,r.getFile(r.aliasesId);case 4:e.t1=e.sent,r.aliases=e.t0.parse.call(e.t0,e.t1),r.setState({aliases:r.aliases});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())),o.push(r.listFiles(Ie).then(function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.origSubsId=t[0].id,e.t0=JSON,e.next=4,r.getFile(r.origSubsId);case 4:e.t1=e.sent,r.origSubs=e.t0.parse.call(e.t0,e.t1),r.setState({origSubs:r.origSubs});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())),o.push(r.listFiles(Se).then(function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r.vttsId=t[0].id,e.t0=JSON,e.next=4,r.getFile(r.vttsId);case 4:e.t1=e.sent,r.vtts=e.t0.parse.call(e.t0,e.t1),r.setState({vtts:r.vtts});case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())),e.next=31,Promise.all(o);case 31:r.changePage("main"),r.getAlbums(),e.next=36;break;case 35:r.changePage("signin");case 36:r.setState({isSignedIn:t});case 37:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.changePage=function(e){var t={curPage:e},a=r.state.curPage;"album"===a&&"main"===e?t.mediaItems=[]:"play"===a&&(t.curItem=null,t.nextResIdx=0),r.setState(t)},r.getAlbums=function(){var e=Object(i.a)(s.a.mark(function e(t){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,r.gapi.client.request({path:"https://photoslibrary.googleapis.com/v1/albums",method:"GET",params:{pageToken:t,pageSize:je}});case 3:a=e.sent,e.next=10;break;case 6:return r.albums=[],e.next=9,r.gapi.client.request({path:"https://photoslibrary.googleapis.com/v1/albums",method:"GET",params:{pageSize:je}});case 9:a=e.sent;case 10:200===a.status?a.result.albums&&(r.albums=r.albums.concat(a.result.albums),r.albums.sort(function(e,t){return(""+e.title).localeCompare(t.title)}),r.setState({albums:r.albums}),a.result.nextPageToken&&r.getAlbums(a.result.nextPageToken)):console.error(a);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.getMediaItems=function(){var e=Object(i.a)(s.a.mark(function e(t,a){var n,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=6;break}return e.next=3,r.gapi.client.request({path:"https://photoslibrary.googleapis.com/v1/mediaItems:search",method:"POST",params:{albumId:t,pageToken:a,pageSize:je}});case 3:n=e.sent,e.next=10;break;case 6:return r.mediaItems=[],e.next=9,r.gapi.client.request({path:"https://photoslibrary.googleapis.com/v1/mediaItems:search",method:"POST",params:{albumId:t,pageSize:je}});case 9:n=e.sent;case 10:200===n.status?(i=n.result.mediaItems)&&(r.mediaItems=r.mediaItems.concat(i),r.setState({mediaItems:r.mediaItems}),n.result.nextPageToken&&r.getMediaItems(t,n.result.nextPageToken)):console.error(n);case 11:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),r.getMediaItem=function(){var e=Object(i.a)(s.a.mark(function e(t){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.gapi.client.request({path:"https://photoslibrary.googleapis.com/v1/mediaItems/"+t,method:"GET"});case 2:200===(a=e.sent).status?r.setState({curItem:a.result}):console.error(a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.onDropAccepted=function(e){var t=e[0],a=new FileReader;a.onload=function(){var e=Object(i.a)(s.a.mark(function e(n){var i,o,c,l,u,p,d,m,f,h,v;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=de()(a.result),o=r.state.curItem.id,c=r.state.origSubs[o],l=r.state.vtts[o],u=t.name.toLowerCase(),e.next=7,r.createFile(t.name);case 7:return p=e.sent,e.next=10,r.writeFile(p,i);case 10:return(d={})[o]=p,r.updateOrigSubs(d),m=ue.a.detect(i),i=ie.a.decode(i,m),f=(f=i.toLowerCase().startsWith("<sami>")?ve()(i):fe.a.convert(i,{format:"vtt"})).replace(/([0-9]),([0-9])/g,"$1.$2"),e.next=19,r.createFile(u+".vtt");case 19:return h=e.sent,e.next=22,r.writeFile(h,f);case 22:(v={})[o]=h,r.updateVtts(v),"play"===r.state.curPage&&r.videoPlayer.updateSubtitle(f),c&&r.delFile(c),l&&r.delFile(l);case 28:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(t)},r.onDropRejected=function(e){console.error("Rejected:",e)},r.playNextRes=Object(i.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.setState({nextResIdx:r.state.nextResIdx+1});case 2:return e.abrupt("return",r.refreshPlayer());case 3:case"end":return e.stop()}},e)})),r.refreshPlayer=Object(i.a)(s.a.mark(function e(){var t,a=arguments;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:0,e.next=3,r.setState({refreshPlayer:!0,currentTime:t});case 3:return e.abrupt("return",r.setState({refreshPlayer:!1}));case 4:case"end":return e.stop()}},e)})),r.listFiles=function(){var e=Object(i.a)(s.a.mark(function e(t){var a,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.gapi.client.drive,e.next=3,a.files.list({q:'name="'+t+'"',spaces:"appDataFolder",fields:"files(id, parents)",pageSize:1e3});case 3:if(200!==(n=e.sent).status){e.next=8;break}return e.abrupt("return",n.result.files);case 8:throw console.error(n),new Error(n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.getFile=function(){var e=Object(i.a)(s.a.mark(function e(t){var a,n,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.gapi.client.drive,n="",e.next=4,a.files.get({fileId:t,alt:"media"});case 4:i=e.sent,e.t0=i.status,e.next=200===e.t0?8:10;break;case 8:return n=i.body,e.abrupt("break",12);case 10:throw console.error(i),new Error(i);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.getFileMetaInfo=function(){var e=Object(i.a)(s.a.mark(function e(t){var a,n,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.gapi.client.drive,n={},e.next=4,a.files.get({fileId:t});case 4:i=e.sent,e.t0=i.status,e.next=200===e.t0?8:10;break;case 8:return n=JSON.parse(i.body),e.abrupt("break",12);case 10:throw console.error(i),new Error(i);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.createFile=function(){var e=Object(i.a)(s.a.mark(function e(t){var a,n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.gapi.client.drive,e.next=3,a.files.create({name:t,parents:["appDataFolder"]});case 3:n=e.sent,e.t0=n.status,e.next=200===e.t0?7:8;break;case 7:return e.abrupt("return",n.result.id);case 8:throw console.error(n),new Error(n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.writeFile=function(){var e=Object(i.a)(s.a.mark(function e(t,a){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.gapi.client.request({path:"/upload/drive/v3/files/"+t,method:"PATCH",params:{uploadType:"media"},body:a});case 2:if(200===(n=e.sent).status){e.next=6;break}throw console.error(n),new Error(n);case 6:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),r.delFile=function(){var e=Object(i.a)(s.a.mark(function e(t){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.gapi.client.request({path:"/drive/v3/files/"+t,method:"DELETE"});case 2:if(a=e.sent,2===Math.floor(a.status/100)||404===a.status){e.next=6;break}throw console.error(a),new Error(a);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),r.render=function(){var e,t=r.props.classes;if("loading"===r.state.curPage)e=h.a.createElement("div",null,"Loading");else if("signin"===r.state.curPage)e=h.a.createElement(G.a,{variant:"outlined",color:"primary",onClick:function(){return r.handleSigninClick()}},"Sign In");else if("main"===r.state.curPage)e=r.state.albums.length>0?h.a.createElement("div",null,h.a.createElement(Ce,{app:Object(d.a)(r)}),h.a.createElement("div",{className:t.demo},h.a.createElement(D.a,null,r.state.albums.map(function(e){return h.a.createElement(R.a,{button:!0,onClick:function(){return r.handleAlbumClick(e)},key:e.id},h.a.createElement(M.a,null,h.a.createElement(J.a,null)),h.a.createElement(_.a,{primary:e.title}))})))):h.a.createElement("div",null,h.a.createElement(Ce,{app:Object(d.a)(r)}),h.a.createElement("div",{className:t.demo},"\ube44\uc5c8\uc74c."));else if("album"===r.state.curPage){var a=r.state.mediaItems,s=[],i=!0,o=!1,c=void 0;try{for(var l,u=a[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var p=l.value;p.mimeType.startsWith("video")&&s.push(p)}}catch(E){o=!0,c=E}finally{try{i||null==u.return||u.return()}finally{if(o)throw c}}for(var m,f=r.state.aliases,v=0,g=s;v<g.length;v++){var b=g[v];b.mimeType.startsWith("video")&&b.id in f&&(b.alias=f[b.id])}s.sort(function(e,t){return(""+(e.alias||e.filename)).localeCompare(t.alias||t.filename)}),m=s.length>0?h.a.createElement(D.a,null,s.map(function(e){return h.a.createElement(R.a,{button:!0,onClick:function(){return r.handleItemClick(e)},key:e.id},h.a.createElement(M.a,null,h.a.createElement(w.a,null,"movie")),h.a.createElement(_.a,{primary:e.alias||e.filename}))})):h.a.createElement(z.a,{container:!0,direction:"column",justify:"space-between",alignItems:"center",className:t.gridContainer,style:{minHeight:"100vh"}},h.a.createElement(z.a,{item:!0}),h.a.createElement(z.a,{item:!0},h.a.createElement(U.a,null,h.a.createElement(j.a,{gutterBottom:!0,style:{fontSize:"10vw"}},"\ud145 \ube44\uc5c8\uc74c!"))),h.a.createElement(z.a,{item:!0})),e=h.a.createElement("div",null,h.a.createElement(Ce,{app:Object(d.a)(r)}),h.a.createElement("div",{className:t.demo},m))}else if("play"===r.state.curPage)if(r.state.curItem)if(r.state.nextResIdx>=Oe.length)e=h.a.createElement("div",null,h.a.createElement(Ce,{app:Object(d.a)(r)}),h.a.createElement("div",null,"\uc601\uc0c1 \uc81c\uc791 \uc911..."));else{for(var y=r.state.curItem,x=[],I=r.state.nextResIdx;I<Oe.length;I++)x.push({src:y.baseUrl+Oe[I].postfix,type:y.mimeType,label:Oe[I].label});var S={height:100,borderWidth:5,borderColor:"#666",borderStyle:"dashed",borderRadius:5},k={borderStyle:"solid",borderColor:"#6c6",backgroundColor:"#eee"};e=h.a.createElement("div",null,h.a.createElement(Ce,{app:Object(d.a)(r)}),h.a.createElement("div",{className:t.demo},h.a.createElement(z.a,{container:!0,direction:"row",justify:"space-evenly",alignItems:"center",className:t.gridContainer},h.a.createElement(z.a,{item:!0,xs:12,style:{padding:10}},!r.state.refreshPlayer&&h.a.createElement(ce.a,{onRef:function(e){r.videoPlayer=e},sources:x,app:Object(d.a)(r)})),h.a.createElement(z.a,{item:!0,xs:8,style:{padding:10}},h.a.createElement($.a,{accept:[".smi",".srt",".vtt"],onDropAccepted:r.onDropAccepted,onDropRejected:r.onDropRejected},function(e){var t=e.getRootProps,a=e.getInputProps,s=e.isDragActive,i=Object(n.a)({},S);return i=s?Object(n.a)({},i,k):i,h.a.createElement("div",Object.assign({},t(),{style:i}),h.a.createElement("input",a()),h.a.createElement(z.a,{container:!0,justify:"center",alignItems:"center",style:{height:"100%"}},h.a.createElement(z.a,{item:!0},h.a.createElement(j.a,{variant:"h4"},h.a.createElement(w.a,{fontSize:"large"},"subtitles"),r.state.vtts[y.id]?"\uc790\ub9c9 \uc788\uc74c":"\uc790\ub9c9 \ub04c\uc5b4\ub193\uae30"))))})),h.a.createElement(z.a,{item:!0,xs:4},r.state.origSubs[y.id]&&h.a.createElement(G.a,{variant:"outlined",color:"default",onClick:function(){return r.handleDownloadSubtitle()}},h.a.createElement(w.a,{className:t.rightIcon},"archive"),"\uc790\ub9c9 \ub2e4\uc6b4"),r.state.vtts[y.id]&&h.a.createElement(G.a,{variant:"outlined",color:"secondary",onClick:function(){return r.handleDelSubtitle()}},h.a.createElement(H.a,{className:t.rightIcon}),"\uc790\ub9c9 \uc0ad\uc81c")))))}else e=h.a.createElement("div",null,h.a.createElement(Ce,{app:Object(d.a)(r)}),h.a.createElement("div",null,"\ubd88\ub7ec\uc624\ub294 \uc911"));return h.a.createElement("div",{className:"App"},h.a.createElement("div",{style:{height:56}}),e)},r}return Object(m.a)(a,t),a}(f.Component);t.a=Object(C.withStyles)(function(e){return{root:{flexGrow:1,maxWidth:"96vw"},demo:{backgroundColor:e.palette.background.paper},title:{margin:"".concat(4*e.spacing.unit,"px 0 ").concat(2*e.spacing.unit,"px")}}})(Te)}).call(this,a(27).Buffer)},143:function(e,t,a){"use strict";var n=a(5),r=a.n(n),s=a(11),i=a(35),o=a(56),c=a(39),l=a(36),u=a(19),p=a(38),d=a(1),m=a.n(d),f=(a(89),a(57));a(233),a(234);a(235)(f.default);var h=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,o=new Array(n),p=0;p<n;p++)o[p]=arguments[p];return(a=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).componentDidMount=function(){a.props.onRef(Object(u.a)(a));var e=a.props.app;a.player=Object(f.default)(a.videoNode,{autoplay:!0,controls:!0,sources:a.props.sources,aspectRatio:"16:9",playbackRates:[.5,1,1.25,1.5,2],controlBar:{children:["playToggle","volumePanel","progressControl","subtitlesButton","playbackRateMenuButton","qualitySelector","fullscreenToggle"]}}),a.player.on("ready",function(){a.player.hotkeys({volumeStep:.1,seekStep:5,enableModifiersForNumbers:!1}),e.state.currentTime&&a.player.currentTime(e.state.currentTime),new Promise(function(){var t=Object(s.a)(r.a.mark(function t(n,s){var i,o;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=e.state.vtts[e.state.curItem.id])){t.next=6;break}return t.next=4,e.getFile(i);case 4:(o=t.sent)?a.updateSubtitle(o):e.handleDelSubtitle();case 6:n();case 7:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}())}),a.player.on("error",function(t){console.error(t);var n=a.player.currentTime();n>2?e.refreshPlayer(n):e.playNextRes()})},a.updateSubtitle=function(e){a.removeSubtitle(),a.player.addRemoteTextTrack({src:"data:text/plain,"+e,default:!0,srclang:"ko"},!1),a.player.textTracks()[0].mode="showing",a.props.app.setState({subtitle:e})},a.removeSubtitle=function(){var e=a.player.textTracks();e.length>0&&a.player.removeRemoteTextTrack(e[0])},a}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentWillUnmount",value:function(){this.player&&this.player.dispose()}},{key:"render",value:function(){var e=this;return m.a.createElement("div",null,m.a.createElement("div",{"data-vjs-player":!0},m.a.createElement("video",{ref:function(t){return e.videoNode=t},className:"video-js",style:{fontSize:"13px"}})))}}]),t}(m.a.Component);t.a=h},166:function(e,t,a){e.exports=a(403)},171:function(e,t,a){},195:function(e,t){},196:function(e,t){},217:function(e,t){},248:function(e,t,a){var n={"./ass.js":249,"./json.js":250,"./lrc.js":251,"./sbv.js":252,"./smi.js":253,"./srt.js":254,"./ssa.js":103,"./sub.js":255,"./vtt.js":256};function r(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=248},272:function(e,t){},403:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(24),i=a.n(s),o=(a(171),a(140));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(o.a,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},58:function(e){e.exports={name:"simple_google_photos_player",version:"0.2.1",private:!0,dependencies:{"@material-ui/core":"^3.9.2","@material-ui/icons":"^3.0.2","arraybuffer-to-buffer":"0.0.5",chardet:"^0.7.0","iconv-lite":"^0.4.24","js-file-download":"^0.4.4",react:"^16.8.3","react-dom":"^16.8.3","react-dropzone":"^9.0.0","react-scripts":"^3.0.1","silvermine-videojs-quality-selector":"^1.1.2",smi2vtt:"^0.1.1",subsrt:"^1.0.0","typeface-roboto":"0.0.54","video.js":"^7.4.1","videojs-hotkeys":"^0.2.25"},scripts:{start:"react-scripts start",build:"react-scripts build",test:"react-scripts test",eject:"react-scripts eject"},eslintConfig:{extends:"react-app"},browserslist:[">0.2%","not dead","not ie <= 11","not op_mini all"],CLIENT_ID:"809549457071-mh6qmdmr0qrkrkursv3cobnl7c3hdvp9.apps.googleusercontent.com",API_KEY:"AIzaSyB470VdtvtHdnbVKfmAMCyYPIl5hFc55PA",DISCOVERY_DOCS:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"]}},89:function(e,t,a){}},[[166,1,2]]]);
//# sourceMappingURL=main.a0a22a34.chunk.js.map